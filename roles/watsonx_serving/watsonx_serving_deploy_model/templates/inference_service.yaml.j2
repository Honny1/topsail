apiVersion: serving.kserve.io/v1beta1
kind: InferenceService
metadata:
  annotations:
    serving.knative.openshift.io/enablePassthrough: "true"
    sidecar.istio.io/inject: "true"
    sidecar.istio.io/rewriteAppHTTPProbers: "true"
    serving.kserve.io/enable-prometheus-scraping: "true"
  name: {{ watsonx_serving_deploy_model_inference_service_name }}
  namespace: {{ watsonx_serving_deploy_model_namespace }}
spec:
  predictor:
{% if watsonx_serving_deploy_model_inference_service_min_replicas is not none %}
    minReplicas: {{ watsonx_serving_deploy_model_inference_service_min_replicas }}
{% endif %}
    serviceAccountName: {{ watsonx_serving_deploy_model_sa_name }}
    model:
      modelFormat:
        name: caikit
      runtime: {{ watsonx_serving_deploy_model_serving_runtime_name }}
      storageUri: {{ watsonx_serving_deploy_model_storage_uri }}
